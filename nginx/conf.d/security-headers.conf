# ═══════════════════════════════════════════════════════
#  Security Headers — OWASP + Modern Best Practices
#  Targets A+ on SecurityHeaders.com
# ═══════════════════════════════════════════════════════

# ─── Prevent clickjacking ───
add_header X-Frame-Options "DENY" always;

# ─── Prevent MIME-type sniffing ───
add_header X-Content-Type-Options "nosniff" always;

# ─── XSS Protection ───
add_header X-XSS-Protection "1; mode=block" always;

# ─── Referrer Policy ───
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

# ─── HSTS — force HTTPS for 2 years + preload ───
add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload" always;

# ─── Permissions Policy — disable unused APIs ───
add_header Permissions-Policy "camera=(), microphone=(), geolocation=(), accelerometer=(), gyroscope=(), magnetometer=(), usb=(), payment=(), interest-cohort=()" always;

# ─── Cross-Origin Policies ───
# add_header Cross-Origin-Embedder-Policy "require-corp" always;
# add_header Cross-Origin-Opener-Policy "same-origin" always;
# add_header Cross-Origin-Resource-Policy "same-origin" always;

# ─── Prevent embedding in objects ───
add_header X-Permitted-Cross-Domain-Policies "none" always;

# ─── DNS Prefetch ───
add_header X-DNS-Prefetch-Control "on" always;

# ─── Content Security Policy ───
# Note: This is a restrictive baseline. Adjust per-app if needed.
add_header X-Download-Options "noopen" always;
